<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <meta charset="utf-8"/>
    <style>
    div {
    width: 1000px;
    margin: auto;
    
    }
       .emprty {
    height: 30px;
    margin: auto;
    }

   table {
   width: 970px; 
   }

   .blank_row
{
    height: 10px !important;
    background-color: dimgray;
}
    </style>
</head>

<body>
<div class="emprty">
</div>
<div align="center"" style="background:dimgray">
    <form id="customform">
        <div>
            <input id ="Title" name="Title" type="text"/>
        </div>
        <div>
            <input id="Description" name="Description" type="text"/>
        </div>
        <div>
            <input type="submit" id="addd" value="Add new" style="background: lightgrey"/>
        </div>
    </form>
</div>

<div align="center" style="background:dimgray">
    <h2>Publications</h2>
    <table id="blogs" style="background:lightgrey"/>
</div>
    
    <script type="text/javascript">
    var uri = 'api/Model';
    $(document).ready(function() {
        $.getJSON(uri)
            .done(function(data) {
                $.each(data,
                    function (key, item) {
                        
                        $('<tr>', { text: formatItemTitle(item) }).appendTo($('#blogs'));
                        $('<tr>', { text: formatItemDescription(item) }).appendTo($('#blogs'));
                        $('<tr>', { text: "Data posted" + " " + formatItemPosted(item) }).appendTo($('#blogs'));
                        $('<tr>', { text: "" }).appendTo($('#blogs'));

                    });
            });
    });

    function formatItemTitle(item) {
        return item.Title;
    };

    function formatItemDescription(item) {
        return item.Description;
    };

    function formatItemPosted(item) {
        return item.Posted;
    };

    function post() {
        $.ajax({
            type: 'POST',
            url: 'api/Model/Post',
            data: JSON.stringify(
            {
                "Title": $("#Title").val(),
                "Description": $("#Description").val()
            }),
            contentType: 'application/json; charset=utf-8',
            dataType: "json",
            async: false
        });
    }

    $("#addd").on("click",
        function(e) {

            $.when(post()).then(
                $.getJSON('api/Model/GetId', '', false)
                .done(function(data) {
                    $('<tr>', { text: formatItemTitle(data) }).appendTo($('#blogs'));
                    $('<tr>', { text: formatItemDescription(data) }).appendTo($('#blogs'));
                    $('<tr>', { text: "Data posted" + " " + formatItemPosted(data) }).appendTo($('#blogs'));
                    $('<tr>', { text: "" }).appendTo($('#blogs'));
                   })
                );
        e.preventDefault();

    });

    </script>
</body>


</html>


